function salvarBicicleta() {    $.ajax({        url: "/novo/control/SalvarBicicleta.php",        type: "POST",        data: $("#fbicicleta").serialize(),        dataType: 'json',        success: function (data, textStatus, jqXHR) {            if (data.situacao === true) {                swal("Bicicleta salvo", data.mensagem, "success");                procurarBicicleta(true);                btNovoBicicleta();            } else if (data.situacao === false) {                swal("Erro", data.mensagem, "error");            }        }, error: function (jqXHR, textStatus, errorThrown) {            swal("Erro", "Erro causado por:" + errorThrown, "error");        }    });}function setarLinhaBicicleta(json) {    $("#fbicicleta #codbicicleta").val(json.codbicicleta);    $("#fbicicleta #nome").val(json.nome);    $("#fbicicleta #localizacao").val(json.localizacao);    if (json.imagem != "") {        $("#div_bicicleta").html("<a target='_blank' href='/sistema/bicicletas/" + json.imagem + "'><i class='fa fa-image' aria-hidden='true'></i> Ver bicicleta</a>");    }}function procurarBicicleta(acao) {    if ($("#listagemBicicleta").length) {        $.ajax({            url: "/novo/control/ProcurarBicicleta.php",            type: "POST",            data: {codmorador: document.fbicicleta.codmorador.value},            dataType: 'text',            success: function (data, textStatus, jqXHR) {                if (acao === false && data === "") {                    swal("Atenção", "Nada encontrado!", "error");                }                if (data != "") {                    data = JSON.parse(data);                    document.getElementById("listagemBicicleta").innerHTML = '<table id="table_bicicleta"></table>';                    var colunas = [                        {"data": "dtcadastro2", title: 'Dt. Cadastro'},                        {"data": "nome", title: 'Nome'},                        {                            "data": "imagem", title: 'Baixar',                            "render": function (data) {                                if (data != "") {                                    return '<a target="_blank" href="/sistema/arquivos/' + data + '"><i class="fa fa-download" aria-hidden="true"></i></a>';                                } else {                                    return "";                                }                            }                        },                        {"data": "funcionario", title: 'Cadastro por'},                        {                            "data": null,                            title: 'Opções',                            render: function (data, type, row) {                                // Combine the first and last names into a single table field                                var bt1 = "<a href='javascript: setarLinhaBicicleta(" + JSON.stringify(row) + ")'><i class='fa fa-pencil' aria-hidden='true'></i></a> ";                                var bt2 = "<a href='javascript: excluirBicicleta(" + row.codbicicleta + ")'><i class='fa fa-trash' aria-hidden='true'></i></a> ";                                return bt1 + bt2;                            }                        }                    ]                    datatableSimples('#table_bicicleta', data, colunas);                } else {                    $("#listagemBicicleta").html('');                }            }, error: function (jqXHR, textStatus, errorThrown) {                swal("Erro ao procurar bicicleta", "Erro causado por:" + errorThrown, "error");            }        });    }}function excluirBicicleta(codbicicleta) {    if (typeof (codbicicleta) == "undefined") {//test do parametro opcional        codbicicleta = $("#codbicicleta").val();    }    swal({        title: "Confirma exclusão?",        text: "Você não poderá mais visualizar as informações dessa bicicleta!",        type: "warning",        showCancelButton: true,        confirmButtonColor: "#DD6B55",        confirmButtonText: "Sim, exclua ele!",        cancelButtonText: "Não",        closeOnConfirm: false,        closeOnCancel: true    }, function (isConfirm) {        if (isConfirm) {            if (codbicicleta !== null && codbicicleta !== "") {                $.ajax({                    url: "/novo/control/Excluir.php",                    type: "POST",                    data: {codbicicleta: codbicicleta, tabela: 'bicicleta'},                    dataType: 'json',                    success: function (data, textStatus, jqXHR) {                        if (data.situacao === true) {                            swal("Bicicleta excluida", data.mensagem, "success");                            procurarBicicleta(false);                            btNovoBicicleta();                        } else if (data.situacao === false) {                            swal("Erro ao excluir", data.mensagem, "error");                        }                    }, error: function (jqXHR, textStatus, errorThrown) {                        swal("Erro ao excluir", "Erro causado por:" + errorThrown, "error");                    }                });            } else {                swal("Campo em branco", "Por favor escolha uma bicicleta para excluir!", "error");            }        }    });}function btNovoBicicleta() {    var codmorador = document.fbicicleta.codmorador.value;    $("#fbicicleta input").val('');    document.fbicicleta.codmorador.value = codmorador;}function abreRelatorioBicicleta(tipo) {    document.getElementById("tipo").value = (tipo === 1) ? "pdf" : "xls";    document.getElementById("fpbicicleta").submit();}/**daqui para baixa responsável pelo ajax de inserir ou atualizar bicicleta e também pelo upload sem redirecionar página*/(function () {    procurarBicicleta(true);    $("#btNovoBicicleta").click(function () {        btNovoBicicleta();    });    $("#btSalvarBicicleta").click(function () {        salvarBicicleta();    });    var progress = $(".progress");    var progressbar = $("#progressbar");    var sronly = $("#sronly");    $("#fbicicleta").submit(function () {        progress.css("visibility", "visible");    }).ajaxForm({        beforeSend: function () {            progress.show();            var percentVal = '0%';            progressbar.width(percentVal);            sronly.html(percentVal + ' Completo');        },        uploadProgress: function (event, position, total, percentComplete) {            var percentVal = percentComplete + '%';            progressbar.width(percentVal);            sronly.html(percentVal + ' Completo');        },        success: function () {            var percentVal = '100%';            progressbar.width(percentVal);            sronly.html(percentVal + ' Completo');        },        complete: function (xhr) {            var data = JSON.parse(xhr.responseText);            if (data.situacao === true) {                swal("Cadastro", data.mensagem, "success");                procurarBicicleta(true);                progress.hide();                btNovoBicicleta();            } else if (data.situacao === false) {                swal("Erro", data.mensagem, "error");            }        }    });})();